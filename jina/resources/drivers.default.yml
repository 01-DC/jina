namespace: jina.drivers

drivers:
  default:
    handlers:
      ControlRequest:
        - handler_control_req
    pre_hooks:
      - hook_add_route_to_msg
    post_hooks:
      - hook_update_timestamp
    help: the default driver configurations for all

  encode:
    handlers:
      /:
        - handler_encode_doc: encode
    help: encode documents into embeddings

  craft-doc:
    handlers:
      /:
        - handler_doc_transform: craft
    help: craft the document-level information

  craft-chunk:
    handlers:
      /:
        - handler_chunk_transform: craft
    help: craft the chunk-level information

  segment:
    handlers:
      /:
        - handler_segment: craft
    help: segment documents into chunks

  index-chunk:
    handlers:
      SearchRequest:
        - handler_chunk_search: query
      IndexRequest:
        - handler_chunk_index: add
    help: index and search embeddings of chunks

  index-chunk-and-meta:
    handlers:
      SearchRequest:
        - handler_chunk_search: query
        - handler_meta_search_chunk: meta_query
      IndexRequest:
        - handler_chunk_index: add
        - handler_prune_chunk
        - handler_meta_index_chunk: meta_add
    help: index and search embeddings and meta information of chunks

  index-meta-chunk:
    handlers:
      SearchRequest:
        - handler_meta_search_chunk: query
      IndexRequest:
        - handler_prune_chunk
        - handler_meta_index_chunk: add
    help: index and search meta information of chunks

  index-meta-doc:
    handlers:
      SearchRequest:
        - handler_meta_search_doc: query
      IndexRequest:
        - handler_prune_doc
        - handler_meta_index_doc: add
    help: index and search meta information of chunks

  clear:
    handlers:
      /:
        - handler_prune_req
    help: remove raw_bytes and heavy binary information from the request

  merge:
    handlers:
      /:
        - merge_routes
    help: merge request routes into one, used in the reducer

  route:
    handlers:
      /:
        - handler_route
    help: pass the request directly to the next pod

  score:
    handlers:
      SearchRequest:
        - handler_prune_chunk  # embedding info on chunk is used and no need anymore
        - handler_chunk2doc_score: score
        - handler_prune_doc  # no need on chunk-level info anymore
    help: lift the topk chunk result to topk doc result

